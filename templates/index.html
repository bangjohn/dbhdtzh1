{% load static %}
<!DOCTYPE html>
<html lang="id">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>TikTokSSS - TikTok Video Downloader</title>
        <!-- Sertakan link CSS untuk Bootstrap atau CSS Anda -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous" />
        <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet" />
        <style>
            /* CSS for the animated loading icon */
            #loadingIcon {
                display: none;
            }
        </style>
        <link rel="icon" href="{% static 'assets/images/TikTokSSS - favicon - tiktoksss.id.png' %}" sizes="32x32" />
    </head>
    <body>
        <header>
            <!-- Navbar -->
            <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
                <div class="container">
                    <a class="navbar-brand" href="https://tiktoksss.id">TikTokSSS</a>
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarNav">
                        <ul class="navbar-nav ml-auto">
                            <li class="nav-item">
                                <a class="nav-link" href="https://tiktoksss.id">Home</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="https://tiktoksss.id/tentang">Tentang TikTokSSS</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="https://tiktoksss.id/kontak">Kontak TikTokSSS</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
        </header>
        <main>
            <div class="container">
                <div class="row">
                    <div class="col-md-8 offset-md-2">
                        <img src="{% static 'assets/images/TikTokSSS - logo - tiktoksss.id.png' %}" class="img-fluid" alt="TikTokSSS" title="TikTokSSS"/>
                        <h1>TikTokSSS - TikTok Video Downloader</h1>
                        <form id="downloadForm" method="post">
                            {% csrf_token %}
                            <div class="form-group">
                                <label for="videoUrl">Masukkan URL TikTok:</label>
                                <input type="text" class="form-control" id="videoUrl" placeholder="Masukkan URL video TikTok" required />
                            </div>
                            <button type="submit" class="btn btn-primary mt-1">Download Video</button>
                        </form>
                        <div id="loadingIcon"><i class="bx bx-loader-circle bx-spin"></i></div>
                        <!-- Add an icon for the loading spinner -->
                        <div id="downloadResult" class="mt-3"></div>
                        <!-- Hasil download video akan ditampilkan di sini -->
                    </div>
                </div>
            </div>
            <div class="container">
                <div class="row">
                    <div class="col-md-8 offset-md-2">
                        <p>
                            TikTokSSS - TikTok Video Downloader: Tempat Terbaik untuk Mendownload Video TikTok Tanpa Watermark
                        </p>
                        <h2>Cara Menggunakan TikTokSSS</h2>
                        <ol>
                            <li>Salin tautan video TikTok yang ingin Anda unduh</li>
                            <li>Buka situs web TikTokSSS di browser Anda</li>
                            <li>Paste tautan video TikTok ke dalam kolom unduh</li>
                            <li>Pilih resolusi video yang diinginkan</li>
                            <li>Klik tombol unduh</li>
                        </ol>
                        <h3>Keuntungan Menggunakan TikTokSSS</h3>
                        <ul>
                            <li>Mendownload video TikTok tanpa watermark</li>
                            <li>Mendownload video TikTok dengan cepat dan mudah</li>
                            <li>Mendownload video TikTok dengan resolusi yang berbeda-beda</li>
                            <li>Mendownload video TikTok dalam format MP4 atau MP3</li>
                            <li>Mendownload video TikTok dengan atau tanpa suara</li>
                            <li>Aman dan terpercaya, tidak menyimpan data pengguna atau tautan video TikTok yang diunduh</li>
                        </ul>
                        <p>
                            TikTok telah menjadi aplikasi yang sangat populer di seluruh dunia. Dengan lebih dari 1 miliar pengguna aktif setiap bulan, TikTok telah menjadi platform sosial media yang sangat populer di kalangan anak muda.
                            Dalam beberapa tahun terakhir, TikTok telah menjadi tempat yang ideal bagi orang-orang untuk mengekspresikan diri mereka dengan membuat dan membagikan video pendek yang kreatif dan menghibur. Namun, sayangnya,
                            aplikasi TikTok tidak menyediakan opsi untuk mengunduh video TikTok ke perangkat Anda. Inilah mengapa TikTokSSS hadir untuk memudahkan Anda dalam melakukan hal tersebut.
                        </p>
                        <p>
                            TikTokSSS adalah salah satu platform terbaik untuk mendownload video TikTok tanpa watermark. Platform ini memungkinkan pengguna untuk mendownload video TikTok dengan mudah dan cepat. TikTokSSS menawarkan berbagai
                            fitur yang memudahkan pengguna untuk mendownload video TikTok tanpa watermark. Selain itu, platform ini juga menyediakan opsi untuk mendownload video TikTok dengan resolusi yang berbeda-beda.
                        </p>
                        <p>
                            Dalam kesimpulannya, TikTokSSS adalah platform yang sangat berguna bagi pengguna TikTok. Platform ini memungkinkan pengguna untuk mendownload video TikTok tanpa watermark dengan cepat dan mudah. Semua fitur yang
                            disediakan oleh platform ini menjadikannya platform terbaik untuk mendownload video TikTok. Jadi, jika Anda ingin mendownload video TikTok tanpa watermark, pastikan untuk mengunjungi TikTokSSS dan nikmati
                            pengalaman unduhan video TikTok yang cepat dan mudah.
                        </p>
                    </div>
                </div>
            </div>
        </main>
        <footer>
            <!-- Tambahkan footer sesuai kebutuhan -->
            <footer class="bg-dark text-white py-4">
                <div class="container">
                    <div class="row">
                        <div class="col-md-12">
                            <p class="text-center">
                                &copy; TikTokSSS.id - All rights reserved. TikTokSSS.id is a web service that allows users to make copies of their own TikToks. TikTokSSS.id or any domains related to the downloading service provided are not
                                affiliated or sponsored by TikTok.com, Bytedance Ltd, or any other associated entity. All rights reserved by their respective owners.
                            </p>
                        </div>
                    </div>
                </div>
            </footer>
        </footer>
        <!-- Sertakan link JavaScript untuk Bootstrap dan script Anda -->
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.0/dist/jquery.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
        <script>
            $(document).ready(function () {
                $("#downloadForm").submit(function (event) {
                    event.preventDefault();
                    var videoUrl = $("#videoUrl").val();

                    // Ganti "YOUR_API_ENDPOINT" dengan URL endpoint dari API TikTok video downloader Anda
                    var apiEndpoint = "/download/"; // Ganti sesuai URL view function yang akan menangani permintaan POST
                    var loadingIcon = $("#loadingIcon");

                    // Ambil CSRF token dari cookie
                    var csrftoken = getCookie("csrftoken");
                    loadingIcon.show();
                    // Kirim permintaan ke API menggunakan AJAX dengan metode POST
                    $.ajax({
                        url: apiEndpoint,
                        type: "POST",
                        data: {
                            videoUrl: videoUrl,
                        },
                        beforeSend: function (xhr, settings) {
                            // Tambahkan CSRF token ke header request
                            xhr.setRequestHeader("X-CSRFToken", csrftoken);
                            loadingIcon.show(); // Show the loading icon before making the request
                        },
                        success: function (response) {
                            // Extract the NoWM video URL from the JSON response
                            var cekSukses = response.success;

                            if (cekSukses) {
                                var noWatermarkVideoUrl = response.data.download.video.NoWM.url;
                                // Tampilkan tombol-tombol pilihan versi video di dalam div dengan id "downloadResult"
                                var downloadLinksHTML = "";
                                var videoVersions = response.data.download.video;
                                for (var version in videoVersions) {
                                    var videoLink = videoVersions[version].url;
                                    var videoSize = videoVersions[version].name;
                                    downloadLinksHTML += `<a href="${videoLink}" class="btn btn-primary" download>Download ${videoSize}</a>`;
                                }
                                $("#downloadResult").html(downloadLinksHTML);
                            } else {
                                $("#downloadResult").html("<div class='alert alert-danger' role='alert'>LINK VIDEO TIKTOKNYA SALAH KONTOL</div>");
                            }

                            loadingIcon.hide();
                        },
                        error: function (error) {
                            console.error("Error:", error);
                            $("#downloadResult").html("<p>Error while downloading video.</p>");
                            loadingIcon.hide();
                        },
                    });
                });

                // Function untuk mendapatkan nilai dari cookie berdasarkan nama
                function getCookie(name) {
                    var value = "; " + document.cookie;
                    var parts = value.split("; " + name + "=");
                    if (parts.length === 2) return parts.pop().split(";").shift();
                }
            });
        </script>
    </body>
</html>
